{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.13", "generated_at": "2025-11-25T13:20:35.643230Z", "invocation_id": "cf938b7d-eb25-426c-b309-c077fe42396e", "invocation_started_at": "2025-11-25T13:20:28.507787Z", "env": {}}, "results": [{"status": "error", "timing": [{"name": "compile", "started_at": "2025-11-25T13:20:29.371483Z", "completed_at": "2025-11-25T13:20:29.377315Z"}, {"name": "execute", "started_at": "2025-11-25T13:20:29.377619Z", "completed_at": "2025-11-25T13:20:35.609516Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 6.257823705673218, "adapter_response": {}, "message": "Database Error in model fact_observations (models/messud/fact_observations.sql)\n  Error HTTPConnectionPool(host='clickhouse-server-project', port=8123): Max retries exceeded with url: /?date_time_input_format=best_effort&cast_string_to_dynamic_use_inference=1&session_id=dbt%3A%3A722e1df7-f5fa-415e-907b-d5bad4187983&mutations_sync=2&insert_distributed_sync=1&send_progress_in_http_headers=1&http_headers_progress_interval_ms=120000&database=messud (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0xffff77a7c790>: Failed to establish a new connection: [Errno 111] Connection refused')) executing HTTP request attempt 2 (http://clickhouse-server-project:8123)\n  compiled code at target/run/clickhouse_dbt_project/models/messud/fact_observations.sql", "failures": null, "unique_id": "model.clickhouse_dbt_project.fact_observations", "compiled": true, "compiled_code": "/* SQL for the fact table Observations\nJoins together data from both GBIF and Aphis datasets using the established models. \nFor GBIF, staging is not used. In the case of APHIs, the staging model stg_aphis_long, which was used to change the data into long format, will be referenced.\n*/\n\n-- Selecting the GBIF data using the established model.\nSELECT\n\to.OrganismKey AS OrganismKey,\n\tl.LocationKey AS LocationKey,\n\td.DateKey AS DateKey,\n\ttoFloat64(gbif.individualCount) AS Occurrence\nFROM `messud`.`stg_gbif` AS gbif\nLEFT JOIN `messud`.`dim_organism` AS o\n\tON gbif.scientificName = o.ScientificName\n\tAND o.is_current = 1\nLEFT JOIN `messud`.`dim_location` AS l\n\tON gbif.decimalLatitude = l.Latitude\n\tAND gbif.decimalLongitude = l.Longitude\nLEFT JOIN `messud`.`dim_date` AS d\n\tON toDate(parseDateTimeBestEffort(splitByChar('/', gbif.eventDate)[1])) = d.FullDate\nUNION DISTINCT\n\n-- Selecting the APHIS data using the established model.\n\nSELECT\n\to.OrganismKey AS OrganismKey,\n\tl.LocationKey AS LocationKey,\n\td.DateKey AS DateKey,\n\ttoFloat64(aphis.value) AS Occurrence\nFROM `messud`.`stg_aphis_long` AS aphis\nLEFT JOIN `messud`.`dim_organism` AS o\n\tON aphis.pest_name = o.Name\n\tAND o.is_current = 1\nLEFT JOIN `messud`.`dim_location` AS l\n\tON aphis.sampling_county = l.County\nLEFT JOIN `messud`.`dim_date` AS d\n\tON makeDate(aphis.sample_year, aphis.sample_month_number, 1) = d.FullDate", "relation_name": "`messud`.`fact_observations`", "batch_results": null}], "elapsed_time": 6.69004487991333, "args": {"macro_debugging": false, "log_level_file": "debug", "require_nested_cumulative_type_params": false, "static_parser": true, "require_resource_names_without_spaces": true, "show_all_deprecations": false, "defer": false, "exclude": [], "partial_parse_file_diff": true, "strict_mode": false, "print": true, "skip_nodes_if_on_run_start_fails": false, "version_check": true, "log_format": "default", "require_explicit_package_overrides_for_builtin_materializations": true, "log_level": "info", "introspect": true, "state_modified_compare_more_unrendered_values": false, "favor_state": false, "printer_width": 80, "state_modified_compare_vars": false, "require_batched_execution_for_custom_microbatch_strategy": false, "source_freshness_run_project_hooks": true, "show_resource_report": false, "use_colors_file": true, "require_all_warnings_handled_by_warn_error": false, "validate_macro_args": false, "write_json": true, "quiet": false, "log_path": "/dbt/logs", "invocation_command": "dbt run --select fact_observations", "send_anonymous_usage_stats": true, "warn_error_options": {"error": [], "warn": [], "silence": []}, "which": "run", "select": ["fact_observations"], "use_fast_test_edges": false, "project_dir": "/dbt", "vars": {}, "upload_to_artifacts_ingest_api": false, "log_format_file": "debug", "require_yaml_configuration_for_mf_time_spines": false, "partial_parse": true, "use_colors": true, "empty": false, "require_generic_test_arguments_property": true, "profiles_dir": "/dbt", "cache_selected_only": false, "log_file_max_bytes": 10485760, "populate_cache": true, "indirect_selection": "eager"}}